(this["webpackJsonpblog-editor"]=this["webpackJsonpblog-editor"]||[]).push([[0],{104:function(t,e,n){"use strict";n.r(e);var r=n(1),a=n(0),c=n.n(a),s=n(17),i=n.n(s),o=(n(49),n(7)),u=n(5),l=function(t,e){switch(e.type){case"login":var n=e.payload.token;return localStorage.setItem("token",n),Object(u.a)(Object(u.a)({},t),{},{isAuthenticated:!0,token:n});case"logout":return localStorage.clear(),Object(u.a)(Object(u.a)({},t),{},{isAuthenticated:!1});default:return t}},j=n(16),b=n(4),p=n(6),d=n.n(p),x=n(12),f=n(15),O=n(13),h=n.n(O),v=n(26),m=n(27);function g(){var t=Object(v.a)(["\n  background-color: ",";\n  border-radius: 20px;\n  padding: 6px;\n  margin: 4px;\n  color: ",";\n  text-align: center;\n"]);return g=function(){return t},t}function y(){var t=Object(v.a)(["\n  align-self: flex-start;\n  color: ",";\n  border: none;\n  background-color: ",";\n  padding: 8px;\n  cursor: pointer;\n  font: inherit;\n"]);return y=function(){return t},t}var w=m.a.button(y(),(function(t){var e=t.variant;return C(e).font}),(function(t){var e=t.variant;return C(e).bg})),k=m.a.div(g(),(function(t){var e=t.variant;return C(e).bg}),(function(t){var e=t.variant;return C(e).font})),C=function(t){switch(t){case"success":return{bg:"#64be10",font:"#fff"};case"danger":return{bg:"#f33434",font:"#fff"};case"warning":return{bg:"#fdc52a",font:"#313131"};default:return{bg:"#2d9ee9",font:"#fff"}}},S=function(){var t=Object(a.useContext)(Y).dispatch,e=Object(a.useState)([]),n=Object(o.a)(e,2),c=n[0],s=n[1],i=Object(a.useState)({email:"",password:""}),l=Object(o.a)(i,2),j=l[0],b=l[1],p=function(t){b(Object(u.a)(Object(u.a)({},j),{},Object(f.a)({},t.target.name,t.target.value)))},O=function(){var e=Object(x.a)(d.a.mark((function e(n){var r,a,c,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,r={headers:{"Content-Type":"application/json"}},a=JSON.stringify(j),e.next=6,h.a.post("/api/auth",a,r);case 6:c=e.sent,t({type:"login",payload:c.data}),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(1),i=e.t0.response.data.errors.map((function(t){return{text:t.msg,type:"danger"}})),s(i),setTimeout((function(){return s([])}),5e3);case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{children:[Object(r.jsx)("h1",{children:"Login"}),c&&c.map((function(t){return Object(r.jsx)(k,{variant:t.type,children:t.text})})),Object(r.jsxs)("form",{onSubmit:function(t){O(t)},children:[Object(r.jsxs)("label",{htmlFor:"email",children:["Email:",Object(r.jsx)("input",{type:"text",id:"email",name:"email",value:j.email,onChange:p})]}),Object(r.jsxs)("label",{htmlFor:"password",children:["Password:",Object(r.jsx)("input",{type:"password",id:"password",name:"password",value:j.password,onChange:p})]}),Object(r.jsx)(w,{children:"Login"})]})]})},A=n(43),T=function(){var t=Object(a.useState)([]),e=Object(o.a)(t,2),n=e[0],c=e[1],s=Object(a.useContext)(Y).state,i=Object(a.useState)([]),l=Object(o.a)(i,2),j=l[0],b=l[1],p=Object(a.useState)({title:"",text:""}),O=Object(o.a)(p,2),v=O[0],m=O[1],g=function(t){m(Object(u.a)(Object(u.a)({},v),{},Object(f.a)({},t.target.name,t.target.value)))},y=function(){var t=Object(x.a)(d.a.mark((function t(e){var n,r,a,i;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),t.prev=1,n={headers:{"Content-Type":"application/json",Authorization:"bearer ".concat(s.token)}},r=j.map((function(t){return t.value})),a=Object(u.a)(Object(u.a)({},v),{},{tags:r}),t.next=7,h.a.post("/api/posts",a,n);case 7:c([{text:"Post submitted",type:"success"}]),e.target.reset(),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(1),i=t.t0.response.data.errors.map((function(t){return{text:t.msg,type:"danger"}})),c(i);case 15:setTimeout((function(){return c([])}),5e3);case 16:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}();return Object(r.jsxs)("div",{children:[n&&n.map((function(t){return Object(r.jsx)(k,{type:t.type,children:t.text})})),Object(r.jsxs)("form",{onSubmit:y,children:[Object(r.jsxs)("label",{htmlFor:"title",children:["Title:",Object(r.jsx)("input",{type:"text",name:"title",id:"title",onChange:function(t){return g(t)},value:v.title})]}),"New post:",Object(r.jsx)("label",{htmlFor:"text",children:Object(r.jsx)("textarea",{type:"text",name:"text",id:"text",onChange:function(t){return g(t)},value:v.text})}),"Tags:",Object(r.jsx)("label",{htmlFor:"tags",children:Object(r.jsx)(A.a,{isMulti:!0,onChange:function(t){b(t)},openMenuOnClick:!1,formatCreateLabel:function(t){return"Add '".concat(t,"'")}})}),Object(r.jsx)(w,{children:"Submit new post"})]})]})},F=n(41),D=n.n(F),E=n(42),I=n.n(E),M=function(){return Object(r.jsx)(I.a,{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, 0)",zIndex:1},type:"Oval"})},P=function(){var t=Object(a.useState)([]),e=Object(o.a)(t,2),n=e[0],c=e[1],s=Object(a.useState)([]),i=Object(o.a)(s,2),u=i[0],l=i[1],b=Object(a.useContext)(Y).state;Object(a.useEffect)((function(){(function(){var t=Object(x.a)(d.a.mark((function t(){var e,n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h.a.get("/api/posts");case 3:e=t.sent,n=e.data,c(n),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}})()()}),[]);var p=function(){var t=Object(x.a)(d.a.mark((function t(e){var r,a,s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=n.filter((function(t){return t._id!==e})),a={headers:{Authorization:"bearer ".concat(b.token)}},t.next=5,h.a.delete("api/posts/".concat(e),a);case 5:l([{type:"warning",text:"Post deleted."}]),c(r),t.next=14;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0),s=t.t0.response.data.errors.map((function(t){return{text:t.msg,type:"danger"}})),l(s);case 14:setTimeout((function(){return l(null)}),5e3);case 15:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}();return Object(r.jsxs)("div",{children:[u&&u.map((function(t,e){return Object(r.jsx)(k,{variant:t.type,children:t.text},e)})),Object(r.jsx)("table",{children:Object(r.jsxs)("tbody",{children:[Object(r.jsxs)("tr",{style:{textAlign:"left"},children:[Object(r.jsx)("th",{children:"Date"}),Object(r.jsx)("th",{children:"Title"}),Object(r.jsx)("th",{children:"Options"})]}),n.length?n.map((function(t){return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:D()(t.date).format("Do, MMM, YYYY")}),Object(r.jsx)("td",{children:t.title}),Object(r.jsxs)("td",{children:[Object(r.jsx)(w,{variant:"danger",onClick:function(){return p(t._id)},children:"Delete"}),Object(r.jsx)(j.b,{to:"/posts/".concat(t._id),children:"Edit"})]})]},t._id)})):Object(r.jsx)(M,{})]})})]})},z=function(){var t=Object(b.f)().id,e=Object(a.useContext)(Y).state,n=Object(a.useState)(),c=Object(o.a)(n,2),s=c[0],i=c[1],l=Object(a.useState)([]),j=Object(o.a)(l,2),p=j[0],O=j[1];Object(a.useEffect)((function(){(function(){var e=Object(x.a)(d.a.mark((function e(){var n,r,a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.a.get("/api/posts/".concat(t));case 3:n=e.sent,r=n.data,a=r.title,c=r.text,i({title:a,text:c}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}})()()}),[t]);var v=function(t){i(Object(u.a)(Object(u.a)({},s),{},Object(f.a)({},t.target.name,t.target.value)))},m=function(){var n=Object(x.a)(d.a.mark((function n(r){var a,c;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r.preventDefault(),n.prev=1,a={headers:{"Content-Type":"application/json",Authorization:"bearer ".concat(e.token)}},n.next=5,h.a.put("/api/posts/".concat(t),s,a);case 5:O([{text:"Post updated",type:"success"}]),n.next=12;break;case 8:n.prev=8,n.t0=n.catch(1),c=n.t0.response.data.errors.map((function(t){return{text:t.msg,type:"danger"}})),O(c);case 12:setTimeout((function(){return O([])}),5e3);case 13:case"end":return n.stop()}}),n,null,[[1,8]])})));return function(t){return n.apply(this,arguments)}}();return Object(r.jsxs)("div",{children:[p&&p.map((function(t){return Object(r.jsx)(k,{variant:t.type,children:t.text})})),s&&Object(r.jsxs)("form",{onSubmit:m,children:[Object(r.jsxs)("label",{htmlFor:"title",children:["Title:",Object(r.jsx)("input",{type:"text",name:"title",id:"title",onChange:function(t){return v(t)},value:s.title})]}),"New post:",Object(r.jsx)("label",{htmlFor:"text",children:Object(r.jsx)("textarea",{type:"text",name:"text",id:"text",onChange:function(t){return v(t)},value:s.text})}),Object(r.jsx)(w,{children:"Submit changes"})]})]})},L=function(){var t=Object(a.useContext)(Y).dispatch;return Object(r.jsx)("nav",{style:{display:"flex",alignItems:"center"},children:Object(r.jsxs)("ul",{style:{listStyle:"none",display:"flex",gap:"14px",alignItems:"center"},children:[Object(r.jsx)("li",{children:Object(r.jsx)(j.b,{to:"/",children:"Home"})}),Object(r.jsx)("li",{children:Object(r.jsx)(j.b,{to:"/newpost",children:"New Post"})}),Object(r.jsx)("li",{children:Object(r.jsx)(w,{variant:"warning",onClick:function(){t({type:"logout"})},children:"Log out"})})]})})},N=function(){var t=Object(a.useContext)(Y).state;return Object(r.jsxs)(j.a,{children:[t.isAuthenticated&&Object(r.jsx)(L,{}),Object(r.jsxs)(b.c,{children:[Object(r.jsx)(b.a,{exact:!0,path:"/newpost",component:t.isAuthenticated?T:S}),Object(r.jsx)(b.a,{exact:!0,path:"/posts/:id",component:t.isAuthenticated?z:S}),Object(r.jsx)(b.a,{exact:!0,path:"/",component:t.isAuthenticated?P:S})]})]})},Y=Object(a.createContext)(),_=function(){var t=Object(a.useReducer)(l,{isAuthenticated:!1,token:null}),e=Object(o.a)(t,2),n=e[0],c=e[1];return Object(a.useEffect)((function(){var t=localStorage.getItem("token");t&&c({type:"login",payload:{token:t}})}),[]),Object(r.jsx)(Y.Provider,{value:{state:n,dispatch:c},children:Object(r.jsx)("div",{children:n.isAuthenticated?Object(r.jsx)(N,{}):Object(r.jsx)(S,{})})})};i.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(_,{})}),document.getElementById("root"))},49:function(t,e,n){}},[[104,1,2]]]);
//# sourceMappingURL=main.b3a840c7.chunk.js.map